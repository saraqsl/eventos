<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cargar ADIF</title>
<style>
body {
  font-family: "Courier New", monospace;
  background: #0b1b2a;
  color: #00ffea;
  text-align: center;
  padding: 30px;
}
input, button {
  margin: 10px;
  padding: 8px;
  border-radius: 5px;
  border: 1px solid #00ffea;
  background: #112233;
  color: #00ffea;
}
button:hover {
  background: #00ffea;
  color: #000;
}
</style>
</head>
<body>

<h1>üì° CARGA DE ARCHIVO ADIF</h1>
<form id="formAdif">
  <input type="text" id="licencia" placeholder="Tu indicativo (ej: LU1ABC)" required><br>
  <input type="email" id="email" placeholder="Tu correo electr√≥nico" required><br>
  <input type="file" id="archivo" accept=".adi,.adif" required><br>
  <button type="submit">Enviar</button>
</form>

<p id="mensaje"></p>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzsJ1Sk-FxZ8c0RUo6SjaU2-jqiQVmOWaHBKMEfXfIAcWxWorObpS7Kcd2Y5o5lG9TP0A/exec";

document.getElementById("formAdif").addEventListener("submit", async (e) => {
  e.preventDefault();

  const licencia = document.getElementById("licencia").value.trim().toUpperCase();
  const correo = document.getElementById("email").value.trim();
  const archivo = document.getElementById("archivo").files[0];
  const mensaje = document.getElementById("mensaje");

  if (!archivo) {
    mensaje.textContent = "‚ö†Ô∏è Seleccion√° un archivo ADIF.";
    return;
  }

  mensaje.textContent = "‚è≥ Enviando...";

  // üß© Convertir archivo a Base64
  const reader = new FileReader();
  reader.onload = async function() {
    try {
      const base64Data = reader.result.split(",")[1];
      const formData = new FormData();
      formData.append("licencia", licencia);
      formData.append("correo", correo);
      formData.append("archivo_base64", base64Data);

      const res = await fetch(SCRIPT_URL, {
        method: "POST",
        body: formData
      });

      const result = await res.json();

      if (result.success) {
        mensaje.textContent = `‚úÖ Archivo cargado correctamente (${result.total} QSOs procesados)`;
      } else {
        mensaje.textContent = `‚ùå Error: ${result.error}`;
      }
    } catch (err) {
      mensaje.textContent = `‚ùå Error: ${err.message}`;
    }
  };
  reader.readAsDataURL(archivo);
});
</script>
</body>
</html>







