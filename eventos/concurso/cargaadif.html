<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Carga de Log ADIF</title>
<style>
  body {
    font-family: "Segoe UI", sans-serif;
    background: #111;
    color: #ddd;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
  }
  form {
    background: #1c1c1c;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 0 10px #000;
    width: 320px;
  }
  h2 {
    text-align: center;
    color: #80ff80;
  }
  label {
    display: block;
    margin-top: 10px;
  }
  input[type="text"],
  input[type="email"],
  input[type="file"] {
    width: 100%;
    margin-top: 5px;
    padding: 6px;
    border: none;
    border-radius: 5px;
  }
  button {
    margin-top: 15px;
    width: 100%;
    padding: 8px;
    background: #28a745;
    border: none;
    color: white;
    border-radius: 6px;
    cursor: pointer;
  }
  button:hover {
    background: #218838;
  }
  #mensaje {
    margin-top: 15px;
    text-align: center;
    color: #80ff80;
  }
</style>
</head>
<body>
 <form id="formAdif">
  <input type="text" id="licencia" placeholder="Licencia" required />
  <input type="email" id="email" placeholder="Correo" required />
  <input type="file" id="archivo" accept=".adi" required />
  <button type="submit">Subir ADIF</button>
</form>

<div id="mensaje" style="margin-top:10px;font-weight:bold;"></div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxEaq443wfj3lGaO1RRmL7Z0tFerQHr9f6eENHqijbzIoCr1ZGP3rTgQSuSPNfSXcsBRA/exec";

document.getElementById("formAdif").addEventListener("submit", async (e) => {
  e.preventDefault();
  const licencia = document.getElementById("licencia").value.trim().toUpperCase();
  const email = document.getElementById("email").value.trim();
  const archivo = document.getElementById("archivo").files[0];
  const mensaje = document.getElementById("mensaje");

  if (!archivo) {
    mensaje.textContent = "⚠️ Seleccioná un archivo ADIF.";
    mensaje.style.color = "orange";
    return;
  }

  mensaje.textContent = "⏳ Subiendo...";
  mensaje.style.color = "gray";

  const reader = new FileReader();
  reader.onload = async () => {
    const base64 = reader.result;

    const formData = new FormData();
formData.append("licencia", licencia);
formData.append("email", email);
formData.append("archivo_base64", base64);

const res = await fetch(SCRIPT_URL, { method: "POST", body: formData });
      const data = await res.json();

      if (data.success) {
        mensaje.textContent = data.resumen || "✅ Archivo subido correctamente.";
        mensaje.style.color = "limegreen";
      } else {
        mensaje.textContent = `❌ Error: ${data.error || "No se pudo procesar el archivo."}`;
        mensaje.style.color = "red";
      }
    } catch (err) {
      mensaje.textContent = "⚠️ Error de conexión con el servidor.";
      mensaje.style.color = "red";
    }
  };
  reader.readAsDataURL(archivo);
});
</script>


